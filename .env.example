# Garage S3 Docker Compose Configuration
# Copy this file to .env and fill in your values

# Domain Configuration
# S3 API will be accessible at: s3.${DOMAIN}
# Buckets will be accessible at: bucket.s3.${DOMAIN}
# Example: example.com â†’ s3.example.com, mybucket.s3.example.com
DOMAIN=example.com

# Security Tokens
# Generate with: ./scripts/generate-secrets.sh
# Or manually with: openssl rand -hex 32

# RPC Secret: Required for cluster node authentication (even single-node)
RPC_SECRET=

# Admin Token: Access to admin API (bucket/key management, status commands)
# Generate with: openssl rand -base64 32
ADMIN_TOKEN=

# Metrics Token: Access to Prometheus metrics endpoint (http://localhost:3903/metrics)
# Required if using Prometheus monitoring - generate with: openssl rand -base64 32
# Used in Prometheus scrape config: Authorization: Bearer ${METRICS_TOKEN}
METRICS_TOKEN=

# S3 Region
# AWS region identifier for S3 clients (can be any string)
S3_REGION=garage

# Storage Paths
# Metadata directory (SSD recommended for performance)
GARAGE_META_DIR=./data/garage-meta

# Object data directory (HDD acceptable for cost efficiency)
GARAGE_DATA_DIR=./data/garage-data

# Optional Settings
# Logging level: error, warn, info, debug, trace
RUST_LOG=info

# Rate Limiting (built-in OpenResty rate limiter)
# Enabled by default. To disable, you must edit docker-compose.yml to expose garage directly.

# Rate limit: requests per second per IP (default: 100)
# Examples: 50, 100, 500, 1000
RATE_LIMIT_RPS=100

# Burst capacity: max requests in a burst (default: 200)
# Should be higher than RPS for smooth operation
RATE_LIMIT_BURST=200

# Dashboard Credentials (Optional)
# If set, the local dashboard (http://localhost:8501) will auto-login.
# Create these by running: docker compose exec s3 /usr/local/bin/garage key create dashboard
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=

# Documentation
# - Setup & Install: docs/INSTALLATION.md
# - Daily Operations: docs/OPERATIONS.md
# - Prometheus Monitoring: docs/PROMETHEUS.md
# - Signed URLs: docs/SIGNED_URLS.md
# - Troubleshooting: docs/TROUBLESHOOTING.md
